---
title: "Are You Really Committed?"
output:
  html_document:
    df_print: paged
---
## Explore
 

```{r}
set.seed(42)
df = read.csv("pml-training.csv")
print(dim(df))
print(names(df))
```

```{r}
summary(df)
```

Task is to predict class given an observation. Procedure: clean data (feature extraction / imputation) and build the prediction model. Data split is random for validation because a time series approach is not taken. Random Forest method is chosen as the classifier.

```{r}
library(caret)
```

## Impute

Impute unknown value with large negative value

```{r}
df[is.na(df)] <- -10000
```


## Split

```{r}
unique(df$classe)
```



```{r}
inTrain = createDataPartition(df$classe,p=3/4)[[1]]

train = df[inTrain,]
# shuffle train data
rows = sample(nrow(train))
train = train[rows,]

test = df[-inTrain,]
```


```{r}
dim(test)
```



## Train random forest model

```{r}
unique(test$classe)
```


```{r}
rfm = train(x=train[c(1:1000),-160],y=train[c(1:1000),]$classe,method='rf')
```
## Test Model




```{r}
confusionMatrix(factor(predict(rfm,test[,-160])),factor(test$classe))
```

## Predict for given test set


```{r}
val = read.csv("pml-testing.csv")
val[is.na(val)] <- -10000

predict(rfm,val[,-160])
```


